v2:~"v"(package @string ~(import @util-functions) ~(bind @substring-from-with-length-deprecated &" str start len|v"(~(let @pos #-1) ~(let @end ~(::pl:: @start @len)) ~"v"(reduce-with-starting ~(string-listify @str) &" item accum|v"(~(set @pos ~(::pl:: @pos #1)) ~"v"(if ~(and ~(::gte:: @pos @start) ~(::lt:: @pos @end)) ~(string-cat @accum @item) @accum)) $))) ~(bind @join-on-deprecated &" strlist separator|v"(~"v"(reduce-with-starting @strlist &" item accum|v"(~"v"(if ~(is-nil @accum) @item ~(string-cat @accum @separator @item))) ^))) ~(bind @split-on-deprecated &" str on|v"(~(let @result [word]()) ~(let @str ~(string-cat @str @on)) ~"v"(reduce-with-starting ~(string-listify @str) &" item accum|v"(~"v"(if ~(equal @item @on) ~"v"(begin ~(set @result ~(cons @accum @result)) $) ~(string-cat @accum @item))) $) ~(util:reverse @result))))