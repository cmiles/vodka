~"begin"v(~"bind"h(@flatten &" nex"v(~"if"v(~"and"h(~"is-list"h(@nex~) ~"is-empty"h(@nex~)~) @nex ~"begin"v(~"bind"h(@first ~"car"h(@nex~)~) ~"bind"h(@rest ~"cdr"h(@nex~)~) ~"if"v(~"is-list"h(@first~) ~"if"v(~"is-empty"h(@first~) ~"flatten"h(@rest~) ~"flatten"h(~"cons"v(~"car"h(@first~) ~"cons"v(~"cdr"h(@first~) @rest~)~)~)~) ~"cons"v(@first ~"flatten"h(~"cdr"h(@nex~)~)~)~)~)~)&)~)~)