~"package"v( @string ~"import"h( @util-functions~) ~"bind"h( @substring-from-with-length-deprecated &" str start len"v( ~"let"h( @pos #-1~) ~"let"h( @end ~"+"h( @start @len~)~) ~"reduce-with-starting"v( ~"string-listify"h( @str~) &" item accum"v( ~"set"h( @pos ~"+"h( @pos #1~)~) ~"if"v( ~"and"h( ~">="h( @pos @start~) ~"<"h( @pos @end~)~) ~"string-cat"h( @accum @item~) @accum~)&) $""~)&)~) ~"bind"h( @join-on-deprecated &" strlist separator"v( ~"reduce-with-starting"v( @strlist &" item accum"v( ~"if"v( ~"is-nil"h( @accum~) @item ~"string-cat"h( @accum @separator @item~)~)&) ^~)&)~) ~"bind"h( @split-on-deprecated &" str on"v( ~"let"h( @result ()~) ~"let"h( @str ~"string-cat"h( @str @on~)~) ~"reduce-with-starting"v( ~"string-listify"h( @str~) &" item accum"v( ~"if"v( ~"equal"h( @item @on~) ~"begin"v( ~"set"h( @result ~"cons"h( @accum @result~)~) $""~) ~"string-cat"h( @accum @item~)~)&) $""~) ~"util:reverse"h( @result~)&)~)~)