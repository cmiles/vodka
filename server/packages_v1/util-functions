~"package"v( @util ~"bind"h( @LOG {}~) ~"bind"h( @log &"() nex"v( ~"cram"h( ~"copy"h( @nex~) @LOG~)&)~) ~"bind"h( @caar &" lst()"v( ~"car"h( ~"car"h( @lst~)~)&)~) ~"bind"h( @cadr &" lst()"v( ~"car"h( ~"cdr"h( @lst~)~)&)~) ~"bind"h( @cdar &" lst()"v( ~"cdr"h( ~"car"h( @lst~)~)&)~) ~"bind"h( @cddr &" lst()"v( ~"cdr"h( ~"cdr"h( @lst~)~)&)~) ~"bind"h( @process &"() list()"v( ~"util:traverse-items-satisfying-and-do"v( @list &"! item"v( ~"is-command"h( @item~)&) &" item~"v( ~"eval"h( @item~)&)~)&)~) ~"bind"h( @range-from-to &"() start# end#"v( ~"if"v( ~">"h( @start @end~) () ~"cons"h( @start ~"range-from-to"h( ~"+"h( @start #1~) @end~)~)~)&)~) ~"bind"h( @reverse &"() lst()"v( ~"reduce-with-starting"v( @lst &" item accum()"v( ~"cons"h( @item @accum~)&) ()~)&)~) ~"bind"h( @traverse-atoms-of-and-do &" lst() f&"v( ~"if"v( ~"is-empty"h( @lst~) @lst ~"begin"v( ~"let"h( @item ~"car"h( @lst~)~) ~"if"v( ~"is-list"h( @item~) ~"cons"h( ~"traverse-atoms-of-and-do"h( @item @f~) ~"traverse-atoms-of-and-do"h( ~"cdr"h( @lst~) @f~)~) ~"cons"h( ~"f"h( @item~) ~"traverse-atoms-of-and-do"h( ~"cdr"h( @lst~) @f~)~)~)~)~)&)~) ~"bind"h( @traverse-items-satisfying-and-do &" lst() testf& dof&"v( ~"if"v( ~"is-empty"h( @lst~) @lst ~"begin"v( ~"let"h( @item ~"car"h( @lst~)~) ~"if"v( ~"testf"h( @item~) ~"cons"v( ~"dof"h( @item~) ~"traverse-items-satisfying-and-do"h( ~"cdr"h( @lst~) @testf @dof~)~) ~"if"v( ~"is-list"h( @item~) ~"cons"v( ~"traverse-items-satisfying-and-do"h( @item @testf @dof~) ~"traverse-items-satisfying-and-do"h( ~"cdr"h( @lst~) @testf @dof~)~) ~"cons"v( @item ~"traverse-items-satisfying-and-do"h( ~"cdr"h( @lst~) @testf @dof~)~)~)~)~)~)&)~) ~"bind"h( @nth-from &" n# lst()"v( ~"if"v( ~"="h( @n #0~) ~"car"h( @lst~) ~"nth-from"h( ~"-"h( @n #1~) ~"cdr"h( @lst~)~)~)&)~) ~"bind"h( @length-of &"# lst()"v( ~"reduce-with-starting"v( @lst &" item accum#"v( ~"+"h( @accum #1~)&) #0~)&)~) ~"bind"h( @list-cat &"() lst1() lst2()"v( ~"if"v( ~"is-empty"h( @lst1~) ~"copy"h( @lst2~) ~"cons"h( ~"car"h( @lst1~) ~"list-cat"h( ~"cdr"h( @lst1~) @lst2~)~)~)&)~) ~"bind"h( @put-contents-in &"() lst() dstlst()"v( ~"list-cat"h( @lst @dstlst~)&)~) ~"bind"h( @contains-item-satisfying &"! lst() f&"v( ~"reduce-with-starting"v( @lst &" item accum()"v( ~"if"v( ~"f"h( @item~) !yes @accum~)&) !no~)&)~) ~"bind"h( @with-only-items-satisfying &"() lst() f&"v( ~"if"v( ~"is-empty"h( @lst~) @lst ~"begin"v( ~"let"h( @item ~"car"h( @lst~)~) ~"if"v( ~"f"h( @item~) ~"cons"h( @item ~"with-only-items-satisfying"h( ~"cdr"h( @lst~) @f~)~) ~"with-only-items-satisfying"h( ~"cdr"h( @lst~) @f~)~)~)~)&)~) ~"bind"h( @lookup-key-in &" key table()"v( ~"let"h( @reclookup &" temptable()"v( ~"if"v( ~"is-empty"h( @temptable~) ^ ~"if"v( ~"equal"h( @key ~"caar"h( @temptable~)~) ~"cadr"h( ~"car"h( @temptable~)~) ~"reclookup"h( ~"cdr"h( @temptable~)~)~)~)&)~) ~"reclookup"h( @table~)&)~) ~"bind"h( @remove-all-entries-with-key-from &"() key table()"v( ~"reduce-with-starting"v( @table &" item accum()"v( ~"if"v( ~"equal"h( @key ~"car"h( @item~)~) @accum ~"cons"h( @item @accum~)~)&) ()~)&)~) ~"bind"h( @add-key-value-to &" key value table()"v( ~"cons"h( ~"cons"h( @key ~"cons"h( @value ()~)~) @table~)&)~) ~"bind"h( @key-is-in &"! key table()"v( ~"contains-item-satisfying"h( @table &" entry"v( ~"equal"h( @key ~"car"h( @entry~)~)&)~)&)~)~)