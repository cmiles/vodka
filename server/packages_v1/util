~"package"v( @util ~"bind"h( @move-contents-to-doc &" lst"v( ~"if"v( ~"is-empty"h( @lst~) {} ~"cons"h( ~"car"h( @lst~) ~"move-contents-to-doc"h( ~"cdr"h( @lst~)~)~)~)&)~) ~"bind"h( @words-only &" lst"v( ~"if"v( ~"is-empty"h( @lst~) [] ~"if"v( ~"is-word"h( ~"car"h( @lst~)~) ~"cons"h( ~"car"h( @lst~) ~"words-only"h( ~"cdr"h( @lst~)~)~) ~"words-only"h( ~"cdr"h( @lst~)~)~)~)&)~) ~"bind"h( @combine-lines &" doc"v( ~"if"v( ~"is-empty"h( @doc~) [] ~"begin"v( ~"let"h( @firstline ~"car"h( @doc~)~) ~"if"v( ~"is-empty"h( @firstline~) ~"begin"v( ~"combine-lines"h( ~"cdr"h( @doc~)~)~) ~"begin"v( ~"let"h( @firstword ~"car"h( @firstline~)~) ~"let"h( @firstline-minus-firstword ~"cdr"h( @firstline~)~) ~"let"h( @doc-minus-firstline ~"cdr"h( @doc~)~) ~"let"h( @newdoc ~"cons"h( @firstline-minus-firstword @doc-minus-firstline~)~) ~"cons"h( @firstword ~"combine-lines"h( @newdoc~)~)~)~)~)~)&)~) ~"bind"h( @LOG {}~) ~"bind"h( @log &" nex"v( ~"cram"h( ~"copy"h( @nex~) @LOG~)&)~) ~"bind"h( @caar &" lst"v( ~"car"h( ~"car"h( @lst~)~)&)~) ~"bind"h( @cadr &" lst"v( ~"car"h( ~"cdr"h( @lst~)~)&)~) ~"bind"h( @cdar &" lst"v( ~"cdr"h( ~"car"h( @lst~)~)&)~) ~"bind"h( @cddr &" lst"v( ~"cdr"h( ~"cdr"h( @lst~)~)&)~) ~"bind"h( @do-for-each &" f lst"v( ~"do-for-each-and-put-in"h( @f @lst ()~)&)~) ~"bind"h( @do-for-each-and-put-in &" f lst dstlst"v( ~"if"v( ~"is-empty"h( @lst~) @dstlst ~"cons"h( ~""h( @f ~"car"h( @lst~)~) ~"do-for-each-and-put-in"h( @f ~"cdr"h( @lst~) @dstlst~)~)~)&)~) ~"bind"h( @range &" start end"v( ~"if"v( ~">"h( @start @end~) () ~"cons"h( @start ~"range"h( ~"+"h( @start #1~) @end~)~)~)&)~) ~"bind"h( @lookup &" nex table"v( ~"let"h( @r ^~) ~"do-for-each"h( &" entry"v( ~"let"h( @key ~"car"h( @entry~)~) ~"if"v( ~"equal"h( @key @nex~) ~"set"h( @r ~"car"h( ~"cdr"h( @entry~)~)~) ^~)&) @table~) @r&)~) ~"bind"h( @flatten &" lst-to-flatten"v( ~"let"h( @remove-leading-empty-lists &" lst"v( ~"if"v( ~"is-empty"h( @lst~) @lst ~"begin"v( ~"let"h( @t ~"car"h( @lst~)~) [ ( |(t)| |(h)| |(i)| |(s)|) |( )| ( |(i)| |(s)|) |( )| ( |(a)| |(n)| |(n)| |(o)| |(y)| |(i)| |(n)| |(g)|) |(,)| |( )| ( |(I)|) |( )| ( |(n)| |(e)| |(e)| |(d)|) |( )| ( |(s)| |(h)| |(o)| |(r)| |(t)|) |( )| ( |(c)| |(i)| |(r)| |(c)| |(u)| |(i)| |(t)|) |( )| ( |(e)| |(v)| |(a)| |(l)|)] ~"if"v( ~"is-list"h( @t~) ~"if"v( ~"is-empty"h( @t~) ~"remove-leading-empty-lists"h( ~"cdr"h( @lst~)~) @lst~) @lst~)~)~)&)~) ~"let"h( @do-flatten &" lst"v( ~"let"h( @usable-lst ~"remove-leading-empty-lists"h( @lst~)~) ~"if"v( ~"is-empty"h( @usable-lst~) () ~"begin"v( ~"let"h( @first ~"car"h( @usable-lst~)~) ~"if"v( ~"is-list"h( @first~) ~"do-flatten"h( ~"cons"h( ~"car"h( @first~) ~"cons"h( ~"cdr"h( @first~) ~"cdr"h( @usable-lst~)~)~)~) ~"cons"h( @first ~"do-flatten"h( ~"cdr"h( @usable-lst~)~)~)~)~)~)&)~) ~"do-flatten"h( @lst-to-flatten~)&)~) ~"bind"h( @select-nth-from-list &" n lst"v( ~"if"v( ~"="h( @n #0~) ~"car"h( @lst~) ~"select-nth-from-list"h( ~"-"h( @n #1~) ~"cdr"h( @lst~)~)~)&)~) ~"bind"h( @list-length &" lst"v( ~"if"v( ~"is-empty"h( @lst~) #0 ~"+"h( #1 ~"list-length"h( ~"cdr"h( @lst~)~)~)~)&)~)~)